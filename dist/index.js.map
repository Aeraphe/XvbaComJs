{"version":3,"file":"index.js","mappings":"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","sources":[".././src/XvbaComJs/UnKnow.ts",".././src/XvbaComJs/XvbaCom.ts",".././src/api/Excel/Excel.ts",".././src/api/Excel/Sheets.ts",".././src/api/Excel/VBComponent.ts",".././src/api/Excel/VBComponents.ts",".././src/api/Excel/VBProject.ts",".././src/api/Excel/WorkBook.ts",".././src/api/Excel/WorkBooks.ts",".././src/api/Ol32/api.ts",".././src/example/excel.ts","../external commonjs2 \"ffi-napi\"","../external commonjs2 \"ref-napi\"","../external node-commonjs \"os\"","../external node-commonjs \"path\"","../webpack/bootstrap",".././src/index.ts"],"sourcesContent":["import * as ref from \"ref-napi\";\r\nimport { ApiOl32 } from \"../api/Ol32/api\";\r\n\r\nconst propType = {\r\n  PROPERTY_GET: 0x2,\r\n  METHOD: 0x1,\r\n  PROPERTY_PUT: 0x4,\r\n  PROPERTY_PUTREF: 0x8,\r\n};\r\n\r\nlet lastComCreate: any;\r\n\r\ninterface IGuid {\r\n  pointer: any;\r\n  type: any;\r\n  name: string;\r\n}\r\n\r\n//GUID Global Unique Identifier List for Created COMs\r\nlet GUIDList: Array<IGuid> = [];\r\n\r\nexport abstract class Unknow {\r\n  guid: IGuid = { pointer: null, type: null, name: \"\" };\r\n  //COM object name\r\n  protected application = \"\";\r\n\r\n  constructor(prop?: any) {\r\n    this.CreateInstace(prop);\r\n  }\r\n\r\n  private CreateInstace(prop?: any) {\r\n    GUIDList.push(this.guid);\r\n    this.guid.type = propType.METHOD;\r\n    this.guid.name = this.constructor.name;\r\n\r\n    if (prop !== undefined && typeof prop === \"string\") {\r\n      this.application = prop || this.application;\r\n    } else if (prop !== undefined && typeof prop !== \"string\") {\r\n      this.guid.pointer = prop;\r\n\r\n      return;\r\n    }\r\n\r\n    if (lastComCreate === undefined) {\r\n      this.CreateTheFirstCom();\r\n    } else {\r\n      this.InitializeMethods();\r\n    }\r\n  }\r\n\r\n  private CreateTheFirstCom = () => {\r\n    const ProgID: any = Buffer.from(this.application + \"\\0\", \"ucs2\");\r\n    let responsePtr: any = ref.alloc(ref.types.uint32);\r\n    const HRESULT = ApiOl32.XvbaCoCreateInstance(ProgID, responsePtr);\r\n    this.guid.pointer = responsePtr;\r\n    lastComCreate = responsePtr;\r\n    console.log(HRESULT);\r\n  };\r\n\r\n  private InitializeMethods() {\r\n    const className = this.constructor.name;\r\n    const classNamePtr: any = Buffer.from(className + \"\\0\", \"ucs2\");\r\n    let responsePtr: any = ref.alloc(ref.types.uint32);\r\n    const HRESULT = ApiOl32.XvbaGetMethod(\r\n      lastComCreate,\r\n      responsePtr,\r\n      classNamePtr\r\n    );\r\n    this.guid.pointer = responsePtr;\r\n    lastComCreate = responsePtr;\r\n    console.log(HRESULT);\r\n  }\r\n\r\n  static ListGUID() {\r\n    return GUIDList;\r\n  }\r\n\r\n  /**\r\n   * Close all Com\r\n   * @param className\r\n   */\r\n  static CloseAllCOM() {\r\n    if (GUIDList.length > 0) {\r\n      GUIDList.map((gui) => {\r\n        console.log(ApiOl32.XvbaRelease(gui.pointer), \":\", gui.name);\r\n      });\r\n      GUIDList = [];\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Close all Com With Delay\r\n   * @param time: number default = 3000ms\r\n   */\r\n  static CloseAllCOMWithDelay(time = 3000) {\r\n    setTimeout(() => {\r\n      if (GUIDList.length > 0) {\r\n        GUIDList.map((gui) => {\r\n          console.log(ApiOl32.XvbaRelease(gui.pointer), \":\", gui.name);\r\n        });\r\n        GUIDList = [];\r\n      }\r\n    }, time);\r\n  }\r\n\r\n  /**\r\n   * Close all Com\r\n   * @param className\r\n   */\r\n  static ReleaseSelectedCom(className?: string) {\r\n    if (GUIDList.length > 0) {\r\n      GUIDList.map((gui) => {\r\n        if (className != undefined) {\r\n          if (gui.name === className) {\r\n            console.log(ApiOl32.XvbaRelease(gui.pointer), \":\", gui.name);\r\n          }\r\n        }\r\n      });\r\n      GUIDList = [];\r\n    }\r\n  }\r\n\r\n  public CloseCOM() {\r\n    ApiOl32.XvbaRelease(this.guid.pointer);\r\n    this.guid = { pointer: null, type: null, name: \"\" };\r\n  }\r\n}\r\n","import { Unknow } from \"./UnKnow\";\r\nimport * as ref from \"ref-napi\";\r\nimport { ApiOl32 } from \"../api/Ol32/api\";\r\n\r\ninterface IResponse {\r\n  objectPtr: any;\r\n  value: any;\r\n}\r\n\r\nexport enum PropType {\r\n  STRING = 0,\r\n  INTEGER = 1,\r\n  BOOLEAN = 2,\r\n}\r\n\r\nexport abstract class XvbaCOM extends Unknow {\r\n  constructor(application?: string) {\r\n    super(application);\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param propToCall <string> the name of the method | property | object to call IDispatch::Invoke\r\n   * @param param <string | number |boolean>\r\n   * @param type\r\n   * @returns\r\n   */\r\n  private _Invoke(\r\n    propToCall: string,\r\n    param: string | number | boolean | Array<any> = \"\",\r\n    type: number = PropType.INTEGER\r\n  ): IResponse | undefined {\r\n    try {\r\n      let param2: any = param;\r\n      let response: IResponse = { objectPtr: null, value: null };\r\n      const params = this._PreparInvokeParams(propToCall, param, type);\r\n      const HRESULT = ApiOl32.XvbaCall(\r\n        params.pPropToCallPtr,\r\n        this.guid.pointer,\r\n        params.paramPtr,\r\n        params.responsePtr,\r\n        params.valuePtr,\r\n        params.inputValueType,\r\n        param2\r\n      );\r\n\r\n      response = { objectPtr: params.responsePtr, value: params.valuePtr };\r\n      console.log(HRESULT, \" : \", propToCall, param);\r\n      return response;\r\n    } catch (error) {\r\n      XvbaCOM.CloseAllCOM();\r\n      console.error(error);\r\n    }\r\n  }\r\n\r\n  private _PreparInvokeParams(\r\n    propToCall: string,\r\n    param: any = \"\",\r\n    type: number\r\n  ) {\r\n    const pPropToCallPtr: any = Buffer.from(propToCall + \"\\0\", \"ucs2\");\r\n\r\n    let responsePtr: any = ref.alloc(ref.types.uint32);\r\n\r\n    const { paramPtr, inputValueType } = this._MakeInputBufferType(param);\r\n\r\n    //Set the response Buffer type\r\n    let valuePtr: any;\r\n    if (type === PropType.INTEGER) {\r\n      valuePtr = ref.alloc(ref.types.int32);\r\n    } else if (type === PropType.STRING) {\r\n      valuePtr = ref.alloc(ref.types.CString);\r\n    }\r\n\r\n    return { pPropToCallPtr, paramPtr, responsePtr, valuePtr, inputValueType };\r\n  }\r\n\r\n  /**\r\n   * Check if the param is number or string for make the correct buffer\r\n   * @param param: any\r\n   * @returns  { paramPtr: Buffer, inputValueType:number }\r\n   */\r\n  private _MakeInputBufferType(param: any) {\r\n    let paramPtr: any;\r\n    let inputValueType = PropType.STRING;\r\n\r\n    if (param !== undefined && param !== \"\") {\r\n \r\n      let bufferType: any;\r\n      switch (typeof param) {\r\n        case \"number\":\r\n          inputValueType = PropType.INTEGER;\r\n          bufferType = ref.types.int32;\r\n          break;\r\n\r\n        case \"string\":\r\n          inputValueType = PropType.STRING;\r\n          bufferType = ref.types.CString;\r\n          break;\r\n\r\n        case \"boolean\":\r\n          inputValueType = PropType.INTEGER;\r\n          bufferType = ref.types.bool;\r\n          break;\r\n      }\r\n      paramPtr = ref.alloc(bufferType, param);\r\n    } else {\r\n  \r\n      paramPtr = ref.NULL;\r\n      inputValueType = 100;\r\n    }\r\n\r\n    return { paramPtr, inputValueType };\r\n  }\r\n\r\n  /**\r\n   *\r\n   * Set Value to COM Property\r\n   *\r\n   * @param propToCall <string> COM Property name\r\n   * @param value string | number value to set to the property\r\n   * @param type <PropType>\r\n   */\r\n  private _SetValue(propToCall: string, value: any = \"\", type: number) {\r\n    const propToCallPtr: any = Buffer.from(propToCall + \"\\0\", \"ucs2\");\r\n\r\n    const { inputValueType, paramPtr } = this._MakeInputBufferType(value);\r\n\r\n    const HRESULT = ApiOl32.XvbaSetVal(\r\n      propToCallPtr,\r\n      this.guid.pointer,\r\n      paramPtr,\r\n      inputValueType\r\n    );\r\n    console.log(HRESULT);\r\n  }\r\n\r\n  /**\r\n   * Call to a COM Method that returns a XvbaCom Object\r\n   *\r\n   * @param propToCall:<string> Method Name\r\n   * @param param : Array | string | number | Boolean\r\n   * @returns XvbaCom\r\n   */\r\n  protected CallMethodToGetObject(\r\n    propToCall: string,\r\n    param: any = \"\",\r\n    XCom: any\r\n  ) {\r\n    try {\r\n      let response: IResponse | undefined = this._Invoke(propToCall, param);\r\n\r\n      if (response !== undefined) {\r\n        return new XCom(response.objectPtr);\r\n      } else {\r\n        throw new Error(\"Fail on CallMethodToGetObject: undefined\");\r\n      }\r\n    } catch (error) {\r\n      XvbaCOM.CloseAllCOM();\r\n      throw new Error(\"Fail on CallMethodToGetObject\");\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Call to a COM Method that returns a String value\r\n   *\r\n   * @param propToCall:<string> Method Name\r\n   * @param param : Array | string | number | Boolean\r\n   * @returns string\r\n   */\r\n  protected CallMethodToGetString(propToCall: string, param: any = \"\") {\r\n    try {\r\n      const response: IResponse | undefined = this._Invoke(propToCall, param);\r\n      if (response !== undefined) {\r\n        return response.value.toString();\r\n      } else {\r\n        throw new Error(\"\");\r\n      }\r\n    } catch (error) {\r\n      XvbaCOM.CloseAllCOM();\r\n      throw new Error(\"Fail on CallMethodToGetString\");\r\n    }\r\n  }\r\n  /**\r\n   * Call to a COM Method that return void\r\n   *\r\n   * @param propToCall:<string> Method Name\r\n   * @param param : Array | string | number | Boolean\r\n   */\r\n  protected CallMethodToGetVoid(propToCall: string, param: any = \"\") {\r\n    try {\r\n      const response: IResponse | undefined = this._Invoke(propToCall, param);\r\n      if (response !== undefined) {\r\n      } else {\r\n        throw new Error(\"Fail on CallMethodToGetNumber\");\r\n      }\r\n    } catch (error) {\r\n      XvbaCOM.CloseAllCOM();\r\n      console.error(error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Call to a COM Method that returns a Number Value\r\n   *\r\n   * @param propToCall:<string> Method Name\r\n   * @param param : Array | string | number | Boolean\r\n   * @returns number\r\n   */\r\n  protected CallMethodToGetNumber(propToCall: string, param: any = \"\") {\r\n    try {\r\n      const response: IResponse | undefined = this._Invoke(propToCall, param);\r\n      if (response !== undefined) {\r\n        return response.value.deref();\r\n      } else {\r\n        throw new Error(\"Fail on CallMethodToGetNumber\");\r\n      }\r\n    } catch (error) {\r\n      XvbaCOM.CloseAllCOM();\r\n      console.error(error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get COM property/Object by name\r\n   *\r\n   * @param prop <string> the COM property Name\r\n   * @returns\r\n   */\r\n  protected GetPropByRef(prop: string) {\r\n    try {\r\n      const classNamePtr: any = Buffer.from(prop + \"\\0\", \"ucs2\");\r\n      let responsePtr: any = ref.alloc(ref.types.uint32);\r\n      const HRESULT = ApiOl32.XvbaGetMethod(\r\n        this.guid.pointer,\r\n        responsePtr,\r\n        classNamePtr\r\n      );\r\n\r\n      console.log(\"getPropByRef\", HRESULT);\r\n      return responsePtr;\r\n    } catch (error) {\r\n      XvbaCOM.CloseAllCOM();\r\n      console.error(error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create COM object\r\n   * @param XvbaCom <XvbaCom>\r\n   * @returns <XvbaCom>\r\n   */\r\n  protected CreateObject(XvbaCom: any) {\r\n    try {\r\n      const response: IResponse | undefined = this._Invoke(XvbaCom.name);\r\n      if (response === undefined) {\r\n        throw new Error(\"Error: GetObject Fail\");\r\n      } else {\r\n        return new XvbaCom(response.objectPtr);\r\n      }\r\n    } catch (error) {\r\n      XvbaCOM.CloseAllCOM();\r\n      console.error(error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get COM number Property value by\r\n   * pass COM property name\r\n   *\r\n   * @param prop <string> COM Property name\r\n   * @returns\r\n   */\r\n  protected GetNumbValue(prop: string): number {\r\n    try {\r\n      const response: IResponse | undefined = this._Invoke(\r\n        prop,\r\n        \"\",\r\n        PropType.INTEGER\r\n      );\r\n      if (response === undefined) {\r\n        throw new Error(\"Error: GetNumbValue Fail\");\r\n      } else {\r\n        return response.value.deref();\r\n      }\r\n    } catch (error) {\r\n      XvbaCOM.CloseAllCOM();\r\n      throw new Error(\"Fail on GetNumbValue\");\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get COM string Property value\r\n   *\r\n   * @param prop <string> COM Property name\r\n   * @returns\r\n   */\r\n  protected GetStrValue(prop: string) {\r\n    try {\r\n      const response: IResponse | undefined = this._Invoke(\r\n        prop,\r\n        \"\",\r\n        PropType.STRING\r\n      );\r\n      if (response === undefined) {\r\n        throw new Error(\"Error: GetStrValue Fail\");\r\n      } else {\r\n        return response.value.deref();\r\n      }\r\n    } catch (error) {\r\n      XvbaCOM.CloseAllCOM();\r\n      console.error(error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   *\r\n   * Set String Value to COM Property\r\n   *\r\n   * @param propToCall <string> COM Property name\r\n   * @param value string value to set to the property\r\n   * @returns void\r\n   */\r\n  protected SetStrValue(propToCall: string, value: string): void {\r\n    try {\r\n      this._SetValue(propToCall, value, PropType.STRING);\r\n    } catch (error) {\r\n      XvbaCOM.CloseAllCOM();\r\n      throw new Error(\"Fail on SetNumbValue\");\r\n    }\r\n  }\r\n\r\n  /**\r\n   *\r\n   * Set Number Value to COM Property\r\n   *\r\n   * @param propToCall <string> COM Property name\r\n   * @param value string value to set to the property\r\n   * @returns void\r\n   */\r\n  protected SetNumbValue(propToCall: string, value: number): void {\r\n    try {\r\n      this._SetValue(propToCall, value, PropType.INTEGER);\r\n    } catch (error) {\r\n      XvbaCOM.CloseAllCOM();\r\n      throw new Error(\"Fail on SetNumbValue\");\r\n    }\r\n  }\r\n\r\n  /**\r\n   *\r\n   * Set Boolean Value to COM Property\r\n   *\r\n   * @param propToCall <string> COM Property name\r\n   * @param value string value to set to the property\r\n   * @returns void\r\n   */\r\n  protected SetBooleanValue(propToCall: string, value: Boolean) {\r\n    try {\r\n      let propType: number;\r\n      if (value === true) {\r\n        propType = PropType.INTEGER;\r\n      } else if (value === false) {\r\n        propType = PropType.STRING;\r\n      } else {\r\n        throw new Error(\"Error: Boolean value not set\");\r\n      }\r\n      return this._SetValue(propToCall, value, propType);\r\n    } catch (error) {\r\n      XvbaCOM.CloseAllCOM();\r\n      throw new Error(\"Fail on SetBooleanValue\");\r\n    }\r\n  }\r\n}\r\n","import { XvbaCOM } from \"../../XvbaComJs/XvbaCom\";\r\nimport { Sheets } from \"./Sheets\";\r\nimport { WorkBooks } from \"./WorkBooks\";\r\n\r\nexport class Excel extends XvbaCOM {\r\n  \r\n  public WorkBooks: WorkBooks;\r\n  private _Sheets: Sheets;\r\n\r\n  public get Sheets(): Sheets {\r\n    if (this._Sheets == undefined) {\r\n      this._Sheets = this.CreateObject(Sheets);\r\n      return this._Sheets;\r\n    } else {\r\n      return this._Sheets;\r\n    }\r\n  }\r\n\r\n  constructor() {\r\n    super(\"Excel.Application\");\r\n    this.WorkBooks = new WorkBooks();\r\n  }\r\n\r\n  Visible = () => this.SetBooleanValue(\"Visible\", true);\r\n\r\n  Name = () => this.GetStrValue(\"Name\");\r\n\r\n  Quit = () => this.CallMethodToGetVoid(\"Quit\");\r\n}\r\n","import { XvbaCOM } from \"../../XvbaComJs/XvbaCom\";\r\n\r\n\r\nexport class Sheets extends XvbaCOM {\r\n\r\n    constructor(param?:any) {\r\n      super(param);\r\n    }\r\n  \r\n    Count(){\r\n      return this.GetNumbValue(\"Count\");\r\n    }\r\n  }\r\n  ","import { XvbaCOM } from \"../../XvbaComJs/XvbaCom\";\r\n\r\nexport class VBComponent extends XvbaCOM {\r\n  private _Name: string;\r\n\r\n  private _Type: number;\r\n\r\n  public get Name(): string {\r\n    if (this._Name == undefined) {\r\n      this._Name = this.GetStrValue(\"Name\");\r\n    }\r\n    return this._Name;\r\n  }\r\n\r\n  public get Type(): number {\r\n    if (this._Type == undefined) {\r\n      this._Type = this.GetNumbValue(\"Type\");\r\n    }\r\n    return this._Type;\r\n  }\r\n\r\n  constructor(param?: any) {\r\n    super(param);\r\n  }\r\n\r\n\r\n  Export(compFilePath:string){\r\n      return this.CallMethodToGetNumber(\"Export\",compFilePath)\r\n  }\r\n\r\n\r\n\r\n}\r\n","import { XvbaCOM } from \"../../XvbaComJs/XvbaCom\";\r\nimport { VBComponent } from \"./VBComponent\";\r\n\r\nexport class VBComponents extends XvbaCOM {\r\n    private _Count: any;\r\n  \r\n    public get Count(): any {\r\n      this._Count = this.GetNumbValue(\"Count\");\r\n      return this._Count;\r\n    }\r\n  \r\n    constructor(prop?: any) {\r\n      super(prop);\r\n    }\r\n\r\n    Item(value:number):VBComponent{\r\n      return this.CallMethodToGetObject(\"Item\",value,VBComponent);\r\n    }\r\n  }\r\n  ","import { XvbaCOM } from \"../../XvbaComJs/XvbaCom\";\r\nimport { VBComponents } from \"./VBComponents\";\r\n\r\nexport class VBProject extends XvbaCOM {\r\n    private _VBComponents: VBComponents;\r\n  \r\n    public get VBComponents(): VBComponents {\r\n      if(this._VBComponents==undefined){\r\n        this._VBComponents = this.CreateObject(VBComponents);\r\n      }\r\n     \r\n      return this._VBComponents;\r\n    }\r\n  \r\n    constructor(prop?: any) {\r\n      super(prop);\r\n        \r\n    }\r\n\r\n    \r\n  }\r\n  ","import { XvbaCOM } from \"../../XvbaComJs/XvbaCom\";\r\nimport { VBProject } from \"./VBProject\";\r\n\r\nexport class WorkBook extends XvbaCOM {\r\n  private _VBProject:VBProject;\r\n\r\n  public get VBProject(): VBProject {\r\n \r\n    if (this._VBProject == undefined) {\r\n      this._VBProject = this.CreateObject(VBProject);\r\n      return this._VBProject\r\n    } else {\r\n      return this._VBProject;\r\n    }\r\n  }\r\n\r\n  public set VBProject(ss:any) {\r\n\r\n       this._VBProject =ss\r\n\r\n  }\r\n\r\n  public get Activate(): any {\r\n    return this.GetNumbValue(\"Activate\");\r\n  }\r\n\r\n  constructor(prop?: any) {\r\n    super(prop);\r\n  }\r\n\r\n  FullName = () => this.GetStrValue(\"FullName\");\r\n}\r\n","import { XvbaCOM } from \"../../XvbaComJs/XvbaCom\";\r\nimport { WorkBook } from \"./WorkBook\";\r\n\r\nexport class WorkBooks extends XvbaCOM {\r\n  \r\n  \r\n  constructor() {\r\n    \r\n    super();\r\n \r\n  }\r\n\r\n  /**\r\n   * Open Excel file\r\n   * @param filePath :string\r\n   * @returns\r\n   */\r\n  Open(filePath: string) {\r\n    return this.CallMethodToGetObject(\"Open\", filePath,WorkBook);\r\n  }\r\n}\r\n","import * as ffi from \"ffi-napi\";\r\nimport * as path from \"path\";\r\nimport * as os from \"os\";\r\n\r\nconst getDllFile = () => {\r\n  if (os.arch() === \"x64\") {\r\n    return path.join(__dirname, \"lib\", \"64\", \"XvbaCom.dll\");\r\n  } else {\r\n    return path.join(__dirname, \"lib\", \"32\", \"XvbaCom.dll\");\r\n  }\r\n};\r\n\r\nexport const ApiOl32 = ffi.Library(getDllFile(), {\r\n  XvbaCoCreateInstance: [\"int\", [\"pointer\", \"pointer\"]],\r\n  XvbaGetMethod: [\"int\", [\"pointer\", \"pointer\", \"pointer\"]],\r\n  XvbaGetPropertyRef: [\"int\", [\"pointer\", \"pointer\", \"pointer\"]],\r\n  XvbaCall: [\r\n    \"int\",\r\n    [\"pointer\", \"pointer\", \"void*\", \"pointer\", \"pointer\", \"int\",\"int\"],\r\n  ],\r\n  XvbaSetVal: [\"int\", [\"pointer\", \"pointer\", \"pointer\", \"int\"]],\r\n  XvbaRelease:[\"int\",[\"pointer\"]],\r\n});\"\"\r\n","\r\nimport { Excel } from \"../api/Excel/Excel\";\r\nimport { WorkBook } from \"../api/Excel/WorkBook\";\r\nimport { VBComponent } from \"../api/Excel/VBComponent\";\r\n\r\nexport const tryExcel = async () => {\r\n  try {\r\n    let excel = new Excel();\r\n\r\n    excel.Visible();\r\n    let Book: WorkBook = excel.WorkBooks.Open(\"F:\\\\Apps\\\\XvbaCom\\\\index.xlsb\");\r\n\r\n    let sheets = excel.Sheets\r\n    \r\n    let total = sheets.Count();\r\n    console.log(\"--->\", total);\r\n    let exName = excel.Name();\r\n    console.log(\"--->\", exName);\r\n    let totalComp =Book.VBProject.VBComponents.Count;\r\n   console.log(\"--->\",totalComp);\r\n\r\n\r\n\r\n   for (let index = 0; index < totalComp; index++) {\r\n\r\n\r\n    const vbComponent :VBComponent = Book.VBProject.VBComponents.Item(index  + 1);\r\n    const compName = vbComponent.Name\r\n    let compFileName = \"\"\r\n\r\n    switch (vbComponent.Type) {\r\n\r\n        case 1:\r\n            compFileName = compName + \".bas\"\r\n            break;\r\n        case 2:\r\n            compFileName = compName + \".cls\"\r\n            break;\r\n        case 3:\r\n            compFileName = compName + \".frm\"\r\n            break;\r\n        case 100:\r\n            compFileName = compName + \".cls\"\r\n            break;\r\n\r\n\r\n        default:\r\n            break;\r\n    }\r\n\r\n\r\n    const fileExport  = \"F:\\\\Apps\\\\XvbaCom\\\\vba\\\\\" + compFileName;\r\n\r\n    vbComponent.Export(fileExport);\r\n\r\n\r\n}\r\n\r\n\r\n\r\nexcel.Quit();\r\n    Excel.CloseAllCOMWithDelay();\r\n  } catch (error) {\r\n    console.log(error);\r\n    Excel.CloseAllCOM();\r\n  }\r\n};\r\n\r\n\r\n","module.exports = require(\"ffi-napi\");","module.exports = require(\"ref-napi\");","module.exports = require(\"os\");","module.exports = require(\"path\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import { tryExcel } from \"./example/excel\";\r\n\r\n\r\n\r\ntryExcel();"],"names":[],"sourceRoot":""}